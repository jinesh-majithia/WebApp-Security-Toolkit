from scanners.sql_injection_scanner import test_sql_injection
from scanners.xss_scanner import test_xss
from scanners.directory_scanner import directory_scan
from scanners.port_scanner import port_scan
import os

def main():
    target_url = input("Enter the target URL (e.g., http://example.com): ")
    
    # SQL Injection Scanner
    print("\n[+] Starting SQL Injection Scanner...")
    test_sql_injection(f"{target_url}?id=")

    # XSS Scanner
    print("\n[+] Starting XSS Scanner...")
    test_xss(f"{target_url}?search=")

    # Directory Scanner
    print("\n[+] Starting Directory Scanner...")
    wordlist_path = os.path.join("..", "resources", "common_dirs.txt")
    directory_scan(target_url, wordlist_path)

    # Port Scanner
    print("\n[+] Starting Port Scanner...")
    port_scan(f"{target_url}")

if __name__ == "__main__":
    main()